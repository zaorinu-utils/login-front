<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Login GitHub OAuth</title>
</head>
<body>
  <h1>Login com GitHub</h1>
  <a href="https://github.com/login/oauth/authorize?client_id=Ov23liDydrs0YSmOnO9m&redirect_uri=https://login-tests-six.vercel.app/api/callback">
    Entrar com GitHub
  </a>

  <p id="user">Você não está logado</p>

  <script>
    const params = new URLSearchParams(window.location.search);
    const token = params.get('token');

    if (token) {
      fetch(`https://login-tests-six.vercel.app//api/validate?token=${token}`)
        .then(res => res.json())
        .then(data => {
          if (data.valid) {
            document.getElementById('user').textContent = `Olá, ${data.username}`;
          } else {
            document.getElementById('user').textContent = 'Token inválido ou expirado';
          }
        })
        .catch(() => {
          document.getElementById('user').textContent = 'Erro na validação do token';
        });
    }
  </script>
</body>
</html>
